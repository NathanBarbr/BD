{% extends "base.html" %}
{% block title %}Tableau de bord{% endblock %}
{% block content %}
<div style="margin-bottom:2rem;">
    <h1>Tableau de bord</h1>
    <p style="color:#6b7280;">Vue d'ensemble des données de la ligue.</p>
</div>

<!-- KPI Cards -->
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;margin-bottom:2rem;">
    <div class="card" style="text-align:center;">
        <div style="font-size:2.5rem;font-weight:bold;color:#4f46e5;">{{ total_players }}</div>
        <div style="color:#6b7280;">Joueurs inscrits</div>
    </div>
    <div class="card" style="text-align:center;">
        <div style="font-size:2.5rem;font-weight:bold;color:#10b981;">{{ total_games }}</div>
        <div style="color:#6b7280;">Matchs joués</div>
    </div>
    <div class="card" style="text-align:center;">
        <div style="font-size:2.5rem;font-weight:bold;color:#f59e0b;">{{ total_clubs }}</div>
        <div style="color:#6b7280;">Clubs actifs</div>
    </div>
</div>

<!-- Charts Section -->
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:1.5rem;">
    <div class="card">
        <h2 style="margin-bottom:1rem;font-size:1.2rem;">Répartition par Nationalité</h2>
        <div style="height:300px;position:relative;">
            <canvas id="citizenshipChart"></canvas>
        </div>
    </div>
    <div class="card">
        <h2 style="margin-bottom:1rem;font-size:1.2rem;">Top 5 Meilleurs Marqueurs</h2>
        <div style="height:300px;position:relative;">
            <canvas id="scorersChart"></canvas>
        </div>
    </div>
</div>

<!-- Chart.js Library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // Data from Flask
    const citizenshipLabels = {{ chart_data.citizenship_labels | tojson }};
    const citizenshipValues = {{ chart_data.citizenship_values | tojson }};
    const scorerLabels = {{ chart_data.scorer_labels | tojson }};
    const scorerValues = {{ chart_data.scorer_values | tojson }};

    // Chart 1: Citizenship (Pie)
    const ctx1 = document.getElementById('citizenshipChart').getContext('2d');
    new Chart(ctx1, {
        type: 'doughnut',
        data: {
            labels: citizenshipLabels,
            datasets: [{
                data: citizenshipValues,
                backgroundColor: [
                    '#4f46e5', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6',
                    '#ec4899', '#06b6d4', '#84cc16', '#f97316', '#6366f1'
                ],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'right'
                }
            }
        }
    });

    // Chart 2: Top Scorers (Bar)
    const ctx2 = document.getElementById('scorersChart').getContext('2d');
    new Chart(ctx2, {
        type: 'bar',
        data: {
            labels: scorerLabels,
            datasets: [{
                label: 'Points Totaux',
                data: scorerValues,
                backgroundColor: '#4f46e5',
                borderRadius: 4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true
                }
            },
            plugins: {
                legend: {
                    display: false
                }
            }
        }
    });
</script>
{% endblock %}